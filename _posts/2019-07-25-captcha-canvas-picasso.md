---
layout: post
title: A mysterious canvas in Google reCAPTCHA
categories: [JavaScript]
tags: [Javascript, crawler]
description: What's inside Google reCAPTCHA?
---

https://github.com/neuroradiology/InsideReCaptcha

Mystery what is inside the Google reCAPTCHA as seems to indicate the number of questions related to this topic on Stack Overflow.

Through this post, I will try to partly answer this question.

Old version of google reCAPTCHA, researchers acknowledged the use of canvas rendering sent along the user agent to verify the nature of the device.
Looking at old scripts, the code of the canvas is similar to the one below (slightly deobfuscated):

```javascript
const canvas = document.createElement('canvas');
canvas.width = 400;
canvas.height = 200;
canvas.style.display = 'block';
const canvasContext = canvas.getContext('2d');
canvasContext.lineWidth = 38;
canvasContext.shadowBlur = 43;
canvasContext.shadowColor = '#be7';
const grd = canvasContext.createRadialGradient(200, 200, 0, 270, 140, 200);
grd.addColorStop(0.25, '#dbe');
grd.addColorStop(0.5, '#317');
grd.addColorStop(1, '#67e');
canvasContext.strokeStyle = grd;
canvasContext.beginPath();
canvasContext.arc(313, 0, 127, 247, 247.5);
canvasContext.stroke();
canvasContext.lineWidth = 5;
canvasContext.shadowBlur = 38;
canvasContext.shadowColor = '#b66';
const grd2 = canvasContext.createLinearGradient(0, 0, 400, 0);
grd2.addColorStop(0, '#88f');
grd2.addColorStop(0.5, '#737');
grd2.addColorStop(1, '#6dc');
canvasContext.strokeStyle = grd2;
canvasContext.font = '88px X';

canvasContext.strokeText('GDp}+7k<', 57, 100);
```

On a mac with Chrome you obtain a canvas similar as the one below. 

<img src="/assets/media/recaptcha_old_canvas.png">


New captcha, behavior seems similar:

```javascript
["ainput",["bgdata","Ly93d3cuZ29vZ2xlLmNvbS9qcy9iZy94UXBZSGY2UnJCYUhGaEswOGxNZ0dzQVZ6Rm0zbTFMVXhxUVlxZnRzZGVJLmpz","","SkxOQkJ4cjN3WktSUW5FRi9EV2JPclprRG5nNjQ0c1VIbnRrNyt0akMxR3ZURklXYncrM1c2c3hub2ZSZk1HZW9WL2JhTnpnYjFWWW1WVWVUY08wRjlLMm9OQ3BMRW1ZekdtTFQ4Nmc1UmFRMGwwRFZOMzFYVHBSQzk3OG9LMnVVclBnMjBJRVdaWlNUNVBwNFBad095NlpSMHVKTWF1UnNLelZqZHNLUHFyekIwM1lFeWZVQXJ4VU5Fb3A3UUFpaGE2S2tkbG1uZFRhaDdOcFlKSElHU0x0THhjSW1MRmVoaDU4VFJOY2RhR01BeE5RbzQ1R2xNN3BZUDlWUUFNMHl4U25SZVVFQU9iMUYya1ZSUmJDL3hnSE1ZV2RRa1hudE9xc3pqVnduTjJKZDU1NnM0ekdoQURMdm9DQTd2WmQyUzNyREZHWkFTNklhMmEwSE5GQkNSaXB0VTZLOGFRbmhjQjUxdlpFYVROc1llbTNzZEpTRGF2cDVtaXBxWGgzeFJtWGp3MEpNRngvU3Y0ck9aMnptSlJmMTRoYk90c05wOFZyRlFFalVhTlloMi9MWElORW9tM0NEcWtjNVp1UDlrSnI2RFk5YzhFd1pKNk5QRUtUOUZ6N0JWR2U0emRlbU1RV0FFMlJpbG0wRnBpbWFqM1d2S1ZIWkpOK2VvS01adWFWZU94N2NZKzJGNWtIb1dXOVBtQVBYUno5QnpLbXArcHR6emkvNnNxeVdnOC9TUVdsdzZmZWRkVGhTWmkvazVKd21ZZkcyUzFDeDZXbVdLVklUQkc2K2J0UHBLQk5XM1NKa2Y3ejdLSE16aWl1c0RadHBxQWg1WUxDYTJHV3A5T3Roa0NDSEdUaG5nWU5VSktlUG42UldLY01obFZ6eW1yRWUwQk5nMi9RaktQT2hXemR6YVVJODFUUlIydXRBejNnbERWVGN6N0wwT3M4SzJ5cUtHemduM0dPWDhSOWxUUTEvRXAreG9BNVpZOFZKSDZic0ViTWVwczNzM3VCNTYyWDQwUk13aitwKyttdVRtRVhqdmp3ZUZMM1ZqQzdmY05YNmJGZnFTWW13cWhBMmVWRzlGd0U1aTJxZ2UxUDVpazVWdlNkc2srNnpLa1hPVWJoZURER0syUDhYdyt6cTB4bTZHT1dTL1dvVEFneGYwNDJHQUt1S05pcjNaSkwxZ3JQWlg5RVZHaEJSQ3g5Z0tHSFJ0SVUzZmJsc0RKOHdLL0t0dmxiNGVoU1FlV0JvRHRMcHRKbEtxZGRsUmZobFJQWTAxaXlmcmJvR293RXk1Y3kwYmhJendWN2VaY2dyakRoRlBJSEpnV0VHeFJGK3FUY2UydjFJaDZlYkFBaE1VZFprZTRBRW5paXhZdmJoWDcyUzNFa0RiZU05elFkZTluWGtnZVlDVnhHWkVBOTZGYlpNM2RuYlBRaVpoNmRhclIrUVNyOFg5eFVmU0d1ZmNYMHpOT0Nad1ZKWVQ2SWtGTlpuTktvRVgzUnBLd3c3TzhXYytDQnI4OTRDbnMrWC9ibFY5bXRhbFNnR2ozbDYxZ1BhK3Vac3lTZEsrZldNZHIzV3JKcGhGS3gwK1JaRGFRd240RkhLMkVyRzdLK3F6RFNVRnQwczk0VmhCbk95eEM3MnFQUnUvbjBSa1ZjRTdlZGorRUU4RjZXN1o3cGwzemNOd1QrK0hWeFZHYVpWU0lyZGovKzRvVVZjSmVEMS9qS2FSRkVIS1BKYkNNaXVYZTFLZHorYXZObnFqTFk3ckwwWFFRSWxTY0tLQlhldy9MTzQ3RTdJVmtrZVJHYTdVTXZTK2I3L1I0NHRnek1vTFBoY21pODROQVNaVVV3cDgyMmtrLzlRbEl1U29xUnlvQXA0dXViQXdjR05uVHhDbExsM2ZacGZ2NWxqZWpLNWk2RjloeHVXRklGamsyUVJvZmZMUC9PQU0yQmwxbmJJWjVUZkNUL2tYUXRnZjNrcGYyeUJZY281NmhGeDBKR09JWmVMazlRYTB5M3F4Zk5SSHNIKzFzTG9nVFk0VDRsci9OSGVzeGhTdmtkb3NjQ2RrK2s5c2hLbW9tZUJCcFRWb1JNRXRlYW1ROEs4NXNMYVdmeHVUT1VTU1RwWkpiTldNaU9EVTQzaFNzV0V5RjFqVE5YcXBTc3Jxamt6bkdRTVJPQ2JwYzNhYk9vOHlKTlorT2dISGlRbmJRckJxMGkxT3dmNHdMdEx5cFk0T0pvZE4yYjZxYlJYSWhWN0ljSmNOVnFiRC81RFRGUFhwRktRZ2Z6TmRtNndFbnZ6QzBFakkyc1dRV0o0R3ArRW5ITHlsdnN5bnRNd0hqQzZsOG9DOUFwZWU5S2ptdlJiQmx0dGZUdTFiUmJaN2tzajdVVFk0TVNlK3IwakxSNzVWaWtKV0s5dlZmUkdZa2JjNjhUektQdDBjWnhsSWxIVGk5QytwVFhSNy9hZ2k1cjVCTUVwaGlIRUhlUHB1RzhPMXdMLytYMSsvdUhlWGRrTTg2Z2dlSGhDZmVKaTYzVWcvNDQ1S2w2Vm55RHJ6NTRJSEM1RkhORkN0M1RMdm1JRkFCYjF3bThacU4ybS94ajQwWi9WZDFoZGtjWCtRRlVjTGNqdm9LZXdsbnZiS1JlckQ4L0ZJd1o1OGk3RmRnaElyTklJeXRwazdXdFlJMDhwQS8wZU9VWmN3bTdSVDVLQkQzMnpJOFYrWnYvcThOM3lJclVFOU82TjdiUk5XMXFaQWdZUUZRZU9lL1BucnhaVzAxK2pod1BUK0JId1FSWDdPNjB6TXNvK0x4bktBcDVSNkRTd01zQjllTVVMd0NYWkxqMW12UTZqckZRS2wxR1dMMTNwU3I2Qk5JYUNkc0hpU1ZzcVR5UjNFV1hQRHRTZHhyZ1VtVmtFTVFreGxlVXhLK1Jyb0lZRDlsOHlScTZtNEI2VXg4bUNQMDJaZDJWelhUVU1QQWxsdjNNQ3Z0TWRJcndlTGFSbkdrVzJMb3JoREJzS29mWmlJWXk1MURDSDVqclh1VDlNYWlxM3RtZ0ovZyt4OWJjKzhHMXgraWVJMTdvOWg0emV1cE9MbjFNa2dTZXYxZWRHaGRxT1ZSTllUWHhOcGdoamhXWXpkbXpreG5uVHFmczVBa3AwY1YzTkFLRjZackRsRkoyVUlNMGg0a2txelJtR1hJM3NNbVNnNnBiQzd1SjdGYitHZjc5RmFiWDVlOHVFTXZSK3JKYWU0cll6UExBdEo0UFkrWVNaOXhPbk9CdmwwdWlaWlI1RXhOVk5iUGlqbG85MlRzT2RjaEZ3SHJhTWF1YTRwc2pZeWRCZnJwZ092UlBXeUN4VGRzWTIvUW9CYkl1ZXB0NlJyeHlKZG1HbHBJaVdOVU5QRm9GSjd1MldoemdDcEhySVQ2UXp2S2FiZCtMSmdOWGFvNjluWlVvdyswKzBrN0JibEZZL0FLa2JPaXVyeHRWalVvcHQxR0RheFBtZkI0NU1LbmUzai9aS2dReUFLLzk1bitVemZORzhmeEZuK2xDRXpLN3gycUdJOTJGWS9QNFEzU3c4VE1jL3p4UEJLbXBqTkZwN1p4bXg3UWJFN2ZwWVJiWER1N1JxVDlYci9tL1NMWk1mWEkrZ2xUWDAyTWZTVktRc3REZFY0aVNOMm5YNG5XOFB1YldJTXVJNkpKRUNNZlA2bjM0aGg2bUVla0R5MGRGUlpLS0F3ZE1hb0ZkOFZOaGo4cFMxbEpZWUVFQ3IxcXFQWHlWd28rNG5DdXo2eFZDamhaNHJXQmx1THROZVN2WkRnUEJoZlJYcW9sd0psM1c1MEdmdm9xeTl0RTdNcnJtQmtJbERLc1dhV2hpbUJ4YmZtb0ZHUWhLYXFma2RJSk00SXpoakRjV2tMeVNKR2g1Q0lnb2l3VHdyeUcrN0FmQkUzT2xFTDB3dmwrOHVvYW9paDN0cjcraHdyQUY3bVhHSVFYdW5Vb2xCV3d4a2VnUDdESks5RERtaUZFNXhZcXdRMlVLc2Q1WTIxRUNDNlcvU1VweTlHdFZsNFFlRFpPQmJWUHJXNU91SU50NHZUR2FxMW9vR1JUcWVzRTRZcWlQVkZ4elRSTlRCOXBuNWtzUzJ2UkRhaDZaSmM1Mkx2T2c2bVVjQTlxRzljd3JVWHVEM0hNaFVlTWR3azFQeXJWT0JBRnRwZWRCNXhnUmxPdzNNemRER1FwL2c3S2t1MlAvYy9kL2lnUlE2S0VldnM5aWtmMWVwdTNmZEMwd1FaVER0bnRCcXB1Qmt3REo3VmpIMThzN0NFa2pXN201VVgyNHlPWFJtSGdMbnJ1YXd5UjlMQ1ByaHV2dmJDZHgwWmxKZjJrcUF5VngvdUgwY05xR3ZEcFFXVVIxZ0lkSjlxQ3ZQU2xXa2dzL1k2MTdNQVlqWlRkektLSlU1bXZKZDNzeXQyYTE4Ykt1R3hXQ24rb1JpMlJ4cFVjVjVVcnpsTVRQU1JxZk5sdFhkTWpaU0pPaS9tMVFUUmYzYWlyeHpycG9xVkJPTnZEMmlyMTRLeS9TVGE0Q1lxbnVTZmlsWVpEVUtBbHMxNWwyNlA3VzB2SWwyeXhIWVd0Y3NvMlhTVUVNeW44YlFHblFudi9XT0VMdVh0R3dnc1NrVVM4NFN1SW1VWjhtZTZqczk4UHplbnZib2dKYSs3RmJBRFVnUXdkMnRabVFBSGUyZzdwTlZxYUlHQzNwelZOVzNEd1U3L0xRdHNUSTNmMm0vVS9vTzM1OFRwZmszbkczTmx0OXFCb2VJRmFyK1FMdWhuaW01LzVrV3ZOa2p1NDVGWmpsKzNtSWVaU202dFltYnBUT3hFWWtQOVNQREU3aWlyaWtRVGxsb3h4YzJYcmVIbnN6UVF0ditvWTdEOFFOY3BrL0cxcUZ6VTVINERaOEtKMlFXZnBpYlAvVWRnUmF4UnYzZis3aU9wODc5eDJ1S1RRenkzd3dZQXAvUGRFZGpTL3RxNmNZcExqNFRMTmYzQnpTbmRIZklZN0RWc1pWVGZneUgwTGZZajNNcEJzajI1STFJZUV2V3hjbnJjeXpMdDVMVDBHMUxtdkVHaTJRaVp1aFJPZ0FNVVNXS1pxWkNjcGZ2eXFHdnkzOGhORTRVb3pBc0IrTE40UTRsT3VFM1hqeUdNOFZuMGU0Tkp4eE10eHJxWG5pdTNONzdjaEVKRktocit6MFRKazUwVlU4T0ZNUE56RkRNN1d3RmpGWHUrVDRtSEY2R05JQ0N4Q0txMmx2RlQyVDFXOTNVTDAyRGJoUVh4Mm81L2JiWHpNQ0ViSFJwZVZaUFNuSlRUTUN4Vk9GS096SllHMjdDQ3JwTnM2eEJnQlpQU0hvNUJhc0xqd0Z1YWpESlBrbE42THVlYmNaYUtiM2JQMjliSk9aa3cvNXJvSThpYkxNNHRVaC82Rm15ZldobytYa2ZBQlk4QWtncWgzbmsxRVVaeHN0eDFaWUpZY3ljaWFIUnh4YzNRQm56VTJuTk9xazAyb09MaDNjcktxQkx6RW1Jcm8xY0xDeHBGelQ0Y3pueEVDRXhyQWFXYk5NV1FkOUhJcElrQm1LeGZOSGllTjRTTVNZTUJWTmxGMTNvNWUrdEZGelpEcDU3YmQ2Z2V6YmpnQlNSUlVsSFNEZmRCTzJvTU13OEN2T25lYUd5VlEwZVZ6MHNaNCtjTDI3azhIQ0tsRmEvRHppNDA3L0VqOE1pTE1EVm1TOGZweG9xeUdnQ25pb1hyUzkwYkVEZEpjT3lyTi9LM0hmWU82bWxKdC9ROFFrdW1xbHdyalFZdndKUHVLb095cWx0TU80a2pmV1ZWN21ZRk5ZOGttWVhTdUJHL2lteWY0Y2Y2R1QwMlRXNHhOZlhzSTFxbEU2S0NZd25CVUU2S0FqWVpHUXAxYUY4OE1kczh1YytYVVpEWS9ybU9aQnZaNm5qQ0NsK2ZnMkdjS3NoWUhLSXcwUnkrOVp2OEhJREQzMisvcityLytHZjZpaGdQTHBSdTdjdjk4eDM0T2xmNWs3ZmFOYkZiMEhhOTNpZGhTamNKZjZ2RzI1S21NV25vRks1Qjc2MDNOcm9jUmVnYkxHTjllTWF4YkNhTENGZ1hoYlQzR1huS0YzelY5MWo0MDFuL0VhRXdmNnB0OUxqWTFYd0FIWVFsL3dZUTNDVHphNWpmUXVaTWV1a2FxZGNIek10S1dIWnh4U2NWSHdOQThSd3owK2RVV1NXaUF6VGhaQTFOT0hPajZ1cENjcWtIWm5FZ3V6ZDZGTXRtNmxSc0RZRzBhbXpQNFQzZXp6NFVyU2cvUnd2RzlvSkNnalJEZzhvYTVIb0F5WEltTHFhbDd2Q1I2RlZKdmE2cmdkLzJlNUNoa2lVYVBjMlp4c0lzemJxUTU2TVFjRVBBK1orOEprcDZkcWNJTHNmS2lqVFVaSkJGaS9ZUWdLTW50ODZDV0dhYkN0YkR3MFV5V0NKOVdpcm5uV3FaM3dMZy9qVmhLMVcwbnd2K0tHN3BNbmlTaC9aeDlJODJhbnZteWZZeU5oUEVMbTZqQVBrNTJRNXlIRHN6cXJOSW5TT3AyT0RzbGsrQ0VaYVNkQ2NoVmVBVHRGbEpUcVh6b2g2U0FoaThpU3VTbUVIY2RvdHlVZUJRZUlXOHFsOFNCQzJ2bnlIYjRVbWRmWlM2MUNPL2RKcHJzWE1OTzNHSnR3ajBraFY3WGFlaW5SdjRDNnFTYklyZlV4RTltNU1pTS9QT2N0T1ZTcEdzaVpUY1NJV1FyVmlZcUo4TDI0WkVFMkt3d3VNeGZZSTg3N3NVZ2E1QlZhaVNQdnNGZWNndlVseWJPd09mYXR2ZjgwQlpPTTMvaDJNcTdRVmFtR0JPNUN6T20vWm15d2N5aW44aWZ3cDZDak1EclVBNU1CNC9HcWZoL2RZU0p1aTAxVjhmSU5FdDVrUGt0YVExcnFMa29uZTNZc0hxZVQvV1Yvb0cvZElkV2EvTVB5VStlUmVBc1YyaVhmM2hKYXMxZnpySW5LZmRkUW5yd25Gc2xpVEhUcERnVDhlWG9nSGpEdm9kWGtaTytLNWljZWhnUDF5bE9ocnlZSkxDQjdYR245ZEpHUkJ4L3ZENmdra1pYbUdMTU5zVU5HcHQzYndUdnlMZTdwM3hPOEZOZDJDT2JWQ1VBcnNtc3J5d3I0cXpyL2xydDFvQ1M0Q1FqQ1d4elN6WjN6T0E3OHhMdU9mYVU2Y21BT3luRGVPV0J2M0lrZXVnVVorWGhrZkVoeHNHZDhGV3JuaDVCWkVNZllkUFFiVHVEU0tOU2RFaHFYSXNvRnQyNDlUSzdJVWdRdVZCTDk4UGtUUnkrdHJpUmZ4alJUaWNjbjd2R1J5WDFtU3N5L2dJTCtsMUJmcndnTk42ekNpeGsvSEhnek5QbTNHVTNRTWwyaGRxQXgzaFp2b1FyMysxYndxdDZPZWl1ZDdPTGgzYWZmVjhuaW9Gd0piR0FvaWdScHNzOFZabUQ5bm41aUtzT2NvVnJYTXRwdmpxdzdsandGVGsvWHRSWmVuZWhCRjIwV2VDQkVKRlhFMEVhK2NIU2x4MU41TlhLZzk4TUZDUlE4azNVUDdyb2s1QjlDSVBWUERPNlAydG9SS2NVRXVKTjJJYWlvbXMvc2lQdVNsV3BkTURxSXIrM0MrR2U2VWk0c0lvSTNqMHVkeWl4RVdQanZaN29uQ05qelo2RU1MVWR1bEc4QnEwOE12aHFjWGN4aEx4TVZES056NGo5eUVMdnRBZHhhNGEyUlBMT2FPeDNacW45TFRpR0VFRmc3Yzc2ODgyMW9QcGQ0M0dIYm1BSC9iaU5hSlJuUVFIZnA4b285bjFhQ3pOYWpOakRZOEk5RlBVOVFjMW5TWTMyT1lTSGRCMFJwN3AvdW9EVWJLVE5CdTZvamZoUFFER0lTRkpqdCsyNERsZUdUbzZCcVBLV1MrSS8xc2ZTTGsyd3J6LzlsVXkrYTBacnpKQWVmT25GMlU2eUxtZmw4RzBDR1Y5engxNktmdkc1MlpZVXZRN2Q4cUcrQmI3Rll4K2Z5Y3VhaEZaRmtkWFFJVjFUYTR1RTk3d09SQUllbnQ4enp5ZmhNR1hGcEtLdllSaXE3cGpwUXNPT09YNlRaaFl0ekhoaU5ZWHNmVndWODFQY3QvaXI3aUsvMXhBckY1RVJFblRjZ0N5Z055VTFFbUVkS2UrUnBwMlM0ek9pQ3RmbU1XVyswTHVTaGpRYVJsTE5ibzhTNzRTYkhhOUFFT3FVTDJlR1VGUUhodmkyY3IzaU1oaTkyRjJ1TXhDRXh0ejROeDdhY1pGRGhSVm1iWUdMY1BFMkU4dXphR0piTWxjaWVKczVJU1RQdHAzdTYyRno3NU1VeStwQStSbjdmMVJpay9ZSFByQWpZTHhyQWFRSzdOSjNNNHgrb015NWpKVThkNURtWUM3ckRtVmM4N1Y2SDJXT1hKYzFOczkvVkFUQWYvOG5mRUJ5eVg3c2trUzhFbGs0RVIzaEIySkJMRXkvKytWRGNRQnJjVUNudGZJOEtSbEtXUGxBbFhvU0Jkek9YalpzNlVZU3MrT3ltTlRDYktyV3lkdStrcnVWMXhxNFNqYTBYTlg4Z0Nka2xleDZRQlBVY25rdDdCc0NCZ0ZrVng5QWRKbHI2U3JQSnI3OHpoRTBYSGcybW9VNnJhTGhLV0VWQ0pjUDhDSXA0WWh0dXM2dkVsYjU2K0d2dmNJcnA2YXVEK092YXhnNlV2VlpZVmpvMFhKb2NoQWxTY0tUSlZpRkpYNkJOenNGZUZKQnEwdUVxWldJOGVEcmpPeWVxUFR3Ti9uaWZJSXZPR2pvdTBDYU1KMGhXVE1nMmdRKzB3RmJuNEp2TWdxZTIvbXM4TzdqcFNVV2ZSUjE4Q2xNTnV1Q1hnY3NGL01uYllUV212YURPNnBUREpKUWxiV2tNb2x0VTRmOG1yNEZmLzJtS1JXb2RIRWd2UVRyekpFSjdHajNlQS9mQUZvdTlxN1gzTXpTTVRtVmZQZFJqL1J5bE90bzNUVkk2VmlhRXJiMzYvbXo3cnNlaStma1l1ZUQ0QmJJRS9UcFFGOWF5SVgwTWdkUXZjVmUzVnBYdG9XbkpWYWczM2lVUkh1MFIxU0JKL01kZWkybmszTlJ4WWtOVXdTQUxQN1RDczY0bzZkWnJ0dVpIL0YrbDlSbXluQmFpVXR6bXZMeHY4R0xYd3dWMnI4UWFvOHVWRUh4akZxaWdMVzduaEo0MkZoWkgwQVJweUVvZ2pDUTlsNU5HZHhCMlhzc2cwaEo4b2Z1bmovUzZhR2NaZjNtUkw1dVVueGdOeVJMN0I0Q2YyS0xtbStiYVZZZjhNczNIMVU3dWpHazVRZTNCTG9xeEdDWlkrRkpYOEl6ckRqYnZwR3lZWW1BTXhKWlJJY0FQRFVkaXVDT0pVMmtIaXNQYXVIa25CUS9pZzZoU29NUmg0YUxzSDNoUUZDWWY0SVR2QTF2YURhQUdGSm03TE5NZGpWc3g1MnJaSnBHWFN2MHJOYXZhYjByeUdPbGJYcDFmVnRQWUhiYmhETHBWUmNXSGNHRFR4QS9oRm45NFZSQkUvdENjOUF5K2QyYkpqRjl6ZWVUSUwyMTlRSEZPMTZOQkZJeGRZd0ZDK2U1dGwrc2dJb2VuMUxKSkdWRWVwOWMyeFYvNHRKQVgxdVhpTXFGTFZrcUl6K1gwNUpXa005b1psdmlac0c2YnNIQVdFc1hXclA4K2hoajBkaFY2aDVCQXkvVGtOZEJ3NUprb2xPR1pwc0ZMUjdid3RxL3JWblFINnlrRHR6cWJMai9JUVhsVXRpa0VYMnpEWHh0SGl5YVJhUHZLNVBPWEtUZ0Erc1VybVBxbmZQaE9EMWRkdUxZY3NkbklrYUhyaEwwdjZHSXZaQWtEc0ZlUkhtejdQb0ptZHJnVHY3eUZpNXZxTmJ5UHp4b2xUV24vTTEzcWdEYlhtOXdVUmd3YWJkNksyVUllWlpyTE9vY2MrRkVralkydllUWTRzbXdoUm9RZzFKbWpOMGozdkpqUDQ1c3MyUS9JdTlOd1c2amJ3bkxIK09vNnJzZjZ2d0dVZWllT0k1N292M0FDWUtHeHgvbHAvSG5FcVpIT1JxdURhZGF0aUJpVHpzN0NYWFhVNnZOY3RIRVBZZGVzK1NrUWREVVgvbXhFSFpERW1yYjROUCtaMHpSYnowV3VSYkRxSDNubDNzTWllcW9hM3RVUzFpUkxUREpLZGRQek9BbExkUUJDVFk4djcwM3Nzak83VXdCWVpGZ2FJLzhsNWtqNkNSRjE0Z0cxN2NoZXhtR2pkK00zSDVpWjkzbHNpcTlKOWhUSWdySkJlektwWWhWbXJZV0FwRWNJNjhncmZBcUNCemlMRGd0cWRYZWIyV05SNDd0VmhZd2tKTHNvTVN6UU5odXJpSjVhUllPcHhhSFFjZUJoZGN4MkJLemgzOVY1UmJsL2VOb3FMdVRkM0d6NGZVc2Y5azhVSWNRbURPdW9ieWVEQVJ2WEpWNUtheElMb0gxVWpkZ2ZqTG4vNkIwKzBhTnNNVFp3ZUp4eUxnbEZDcE1zYmhPbjZBV2RONlQvTmJ2Z1BHQWtETThlVmVZa3Y5aERnT282b1RPNGFSMFpoWXZXdFVQaUhIdHB3N0FBcUxrRDBML2ZibnVCcXF6YktIU2gydXQxdHMyb1N6NldMT1pVcm9GeHRsdWttWWx5SmZ2Nm9hbDNoaDFtVWtqYnFmQzIzSG9LUFIxcGJFUkR5M3pXQW04aUFZTTFPWTZtZjVUTjJ0bHhiRkFZTDB0STN1QWdEa0RNeTdrTlRkNHdXK2Z1TUpxamgrc3hubHg0b3k4c1RINStOYm5BdzI0bHR4NkVheWdJakJkMEdzOG1obDFveVZWc0UyQW80ZmxhbHV6TGVUdG12WjB0NDFEN0dXVUtGc3lwaDRHZjVIaFZrYmdCNTVXaGlPdDloTjUyREJPOWw1aWQzd1J5M0V4QkJ5ZEtnSWFlZlEwcmNNSk9GbHgvL2Yy"]
,null,["conf",null,"6Ld2sf4SAAAAAKSgzs0Q13IZhY02Pyo31S2jgOB5",0,null,["JS_FASTCLICK","JS_MC_FETCH"]
]
,"https://patrickhlauke.github.io:443",["ctask",[["hctask","c61eba65","47e2caf1e8d0caa14678609ebe150c4aafd0b28be21d492bce38e44166fc19bd",0,100]
,["hctask","048c56fe","e257baf9260912d1d51ced897ea1c00f410571d8fea7ce475b04dae953155cbb",0,100]
,["hctask","f40997e0","2fabf30010db23f240d768ddc5d7b29072559170d40b06177e07118b25665972",0,100]
]
,"/recaptcha/api2/webworker.js"]
,[1,1,1]
,null,null,["ftask",[5,2]
]
,0,3600,["https://www.google.com/intl/fr/policies/privacy/","https://www.google.com/intl/fr/policies/terms/"]
]
```


```javascript
atob("Ly93d3cuZ29vZ2xlLmNvbS9qcy9iZy94UXBZSGY2UnJCYUhGaEswOGxNZ0dzQVZ6Rm0zbTFMVXhxUVlxZnRzZGVJLmpz")
// "//www.google.com/js/bg/xQpYHf6RrBaHFhK08lMgGsAVzFm3m1LUxqQYqftsdeI.js"
```

If similar to what xxx posted, seems to be the vm interpreter.

Second parameter must be double b64 encoded bytecode.


data: "recaptcha-setup"

"JS_FASTCLICK","JS_BFRAME","JS_MC_FETCH","JS_PT"

Multiple files from 2017, 2018, seems to have only 2 getContext, code changed
https://github.com/0x92/G.A.T.E-Research/blob/16a81a0c37696e7da72238ad857a05e2c4561c1e/ressources/_x_%20-%20GATE%20Searching%20intelligent%20individuals%20with%20ADHD_ADD%20-%20Paranormal%20-%204chan_files/recaptcha__de.js.Download


function test() {
	try {
                var n = u.createElement("canvas")
                  , t = n.getContext("webgl");
                if (t) {
                    var i = t.getExtension("WEBGL_lose_context");
                    i && i.loseContext()
                }
                return 'toto'
            } catch (r) {
                return 'tata'
            }
}
test()
